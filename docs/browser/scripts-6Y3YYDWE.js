(function(b,w){typeof exports=="object"&&typeof module<"u"?module.exports=w():typeof define=="function"&&define.amd?define(w):(b=typeof globalThis<"u"?globalThis:b||self).jsVectorMap=w()})(this,function(){"use strict";Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(i){for(var s=(this.document||this.ownerDocument).querySelectorAll(i),e=s.length;--e>=0&&s.item(e)!==this;);return e>-1}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(i){if(i==null)throw new TypeError("Cannot convert first argument to object");for(var s=Object(i),e=1;e<arguments.length;e++){var t=arguments[e];if(t!=null){t=Object(t);for(var a=Object.keys(Object(t)),r=0,o=a.length;r<o;r++){var n=a[r],h=Object.getOwnPropertyDescriptor(t,n);h!==void 0&&h.enumerable&&(s[n]=t[n])}}}return s}});var b={},w=1,O=function(i,s,e,t){t===void 0&&(t={});var a="jvm:"+s+"::"+w++;b[a]={selector:i,handler:e},e._uid=a,i.addEventListener(s,e,t)},D=function(i,s,e){var t=s.split(":")[1];i.removeEventListener(t,e),delete b[e._uid]},P=function(){return b},I=function(){function i(e){return e instanceof Element?(this.selector=e,this):(this.selector=document.querySelector(e),this)}var s=i.prototype;return s.on=function(e,t,a){return a===void 0&&(a={}),O(this.selector,e,t,a),this},s.delegate=function(e,t,a){for(var r in t=t.split(" "))this.on(t[r],function(o){var n=o.target;n.matches(e)&&a.call(n,o)})},s.css=function(e){for(var t in e)this.selector.style[t]=e[t];return this},s.text=function(e){return e?(this.selector.textContent=e,this):this.selector.textContent},s.attr=function(e,t){return e&&t?(this.selector.setAttribute(e,t),this):this.selector.getAttribute(e)},s.addClass=function(e){return this.selector.classList?(this.selector.classList.add(e),this):(this.selector.className.split(" ").indexOf(e)==-1&&(this.selector.className+=" "+e),this)},s.append=function(e){return this.selector.appendChild(e),this},s.show=function(){this.css({display:"block"})},s.hide=function(){this.css({display:"none"})},s.height=function(){return this.selector.offsetHeight},s.width=function(){return this.selector.offsetWidth},i}(),H=function(i){return function(s){return!!s&&typeof s=="object"}(i)&&!function(s){var e=Object.prototype.toString.call(s);return e==="[object RegExp]"||e==="[object Date]"||function(t){return t.$$typeof===B}(s)}(i)},B=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function S(i,s){return s.clone!==!1&&s.isMergeableObject(i)?j((e=i,Array.isArray(e)?[]:{}),i,s):i;var e}function R(i,s,e){return i.concat(s).map(function(t){return S(t,e)})}function X(i){return Object.keys(i).concat(function(s){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(s).filter(function(e){return s.propertyIsEnumerable(e)}):[]}(i))}function Y(i,s){try{return s in i}catch{return!1}}function G(i,s,e){var t={};return e.isMergeableObject(i)&&X(i).forEach(function(a){t[a]=S(i[a],e)}),X(s).forEach(function(a){(function(r,o){return Y(r,o)&&!(Object.hasOwnProperty.call(r,o)&&Object.propertyIsEnumerable.call(r,o))})(i,a)||(Y(i,a)&&e.isMergeableObject(s[a])?t[a]=function(r,o){if(!o.customMerge)return j;var n=o.customMerge(r);return typeof n=="function"?n:j}(a,e)(i[a],s[a],e):t[a]=S(s[a],e))}),t}var j=function(i,s,e){(e=e||{}).arrayMerge=e.arrayMerge||R,e.isMergeableObject=e.isMergeableObject||H,e.cloneUnlessOtherwiseSpecified=S;var t=Array.isArray(s);return t===Array.isArray(i)?t?e.arrayMerge(i,s,e):G(i,s,e):S(s,e)},l={isImageUrl:function(i){return/\.(jpg|gif|png)$/.test(i)},createElement:function(i,s,e,t){t===void 0&&(t=!1);var a=document.createElement(i);return e&&(a[t?"innerHTML":"textContent"]=e),s&&(a.className=s),a},removeElement:function(i){i.parentNode.removeChild(i)},$:function(i){return new I(i)},hyphenate:function(i){return i.replace(/[\w]([A-Z])/g,function(s){return s[0]+"-"+s[1]}).toLowerCase()},isFunc:function(i){return typeof i=="function"},isObj:function(i){return typeof i=="object"},isStr:function(i){return typeof i=="string"},isArr:function(i){return Array.isArray(i)},merge:function(i,s){return Object.assign(i,s)},mergeDeeply:function(i,s){return j(i,s)},keys:function(i){return Object.keys(i)}};function y(i,s){i.prototype=Object.create(s.prototype),i.prototype.constructor=i,L(i,s)}function L(i,s){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(i,s)}var k=function(){function i(e,t){this._name=e,this.node=this.createElement(e),t&&this.set(t)}var s=i.prototype;return s.createElement=function(e){return document.createElementNS("http://www.w3.org/2000/svg",e)},s.addClass=function(e){this.node.setAttribute("class",e)},s.getBBox=function(){return this.node.getBBox()},s.set=function(e,t){if(l.isObj(e))for(var a in e)this.applyAttr(a,e[a]);else this.applyAttr(e,t)},s.get=function(e){return this.style.initial[e]},s.applyAttr=function(e,t){this.node.setAttribute(l.hyphenate(e),t)},s.remove=function(){this.node.parentNode.removeChild(this.node)},i}(),x=function(i){function s(t,a,r){var o;return r===void 0&&(r={}),(o=i.call(this,t,a)||this).isHovered=!1,o.isSelected=!1,o.style=r,o.style.current={},o.updateStyle(),o}y(s,i);var e=s.prototype;return e.setStyle=function(t,a){var r;l.isObj(t)?l.merge(this.style.current,t):l.merge(this.style.current,((r={})[t]=a,r)),this.updateStyle()},e.updateStyle=function(){var t={};l.merge(t,this.style.initial),l.merge(t,this.style.current),this.isHovered&&l.merge(t,this.style.hover),this.isSelected&&(l.merge(t,this.style.selected),this.isHovered&&l.merge(t,this.style.selectedHover)),this.set(t)},s}(k),V=function(i){function s(e,t){return i.call(this,"text",e,t)||this}return y(s,i),s.prototype.applyAttr=function(e,t){e==="text"?this.node.textContent=t:i.prototype.applyAttr.call(this,e,t)},s}(x),W=function(i){function s(e,t){return i.call(this,"image",e,t)||this}return y(s,i),s.prototype.applyAttr=function(e,t){var a;e==="image"?(l.isObj(t)?(a=t.url,this.offset=t.offset||[0,0]):(a=t,this.offset=[0,0]),this.node.setAttributeNS("http://www.w3.org/1999/xlink","href",a),this.width=23,this.height=23,this.applyAttr("width",this.width),this.applyAttr("height",this.height),this.applyAttr("x",this.cx-this.width/2+this.offset[0]),this.applyAttr("y",this.cy-this.height/2+this.offset[1])):e=="cx"?(this.cx=t,this.width&&this.applyAttr("x",t-this.width/2+this.offset[0])):e=="cy"?(this.cy=t,this.height&&this.applyAttr("y",t-this.height/2+this.offset[1])):i.prototype.applyAttr.apply(this,arguments)},s}(x),F=function(i){function s(t){var a;return(a=i.call(this,"svg")||this)._container=t,a._defsElement=new k("defs"),a._rootElement=new k("g",{id:"jvm-regions-group"}),a.node.appendChild(a._defsElement.node),a.node.appendChild(a._rootElement.node),a._container.append(a.node),a}y(s,i);var e=s.prototype;return e.setSize=function(t,a){this.node.setAttribute("width",t),this.node.setAttribute("height",a)},e.applyTransformParams=function(t,a,r){this._rootElement.node.setAttribute("transform","scale("+t+") translate("+a+", "+r+")")},e.createPath=function(t,a){var r=new x("path",t,a);return r.node.setAttribute("fill-rule","evenodd"),this.add(r)},e.createCircle=function(t,a,r){var o=new x("circle",t,a);return this.add(o,r)},e.createLine=function(t,a,r){var o=new x("line",t,a);return this.add(o,r)},e.createText=function(t,a,r){var o=new V(t,a);return this.add(o,r)},e.createImage=function(t,a,r){var o=new W(t,a);return this.add(o,r)},e.createGroup=function(t){var a=new k("g");return this.node.appendChild(a.node),t&&(a.node.id=t),a.canvas=this,a},e.add=function(t,a){return(a=a||this._rootElement).node.appendChild(t.node),t},s}(k);function T(i,s,e){var t=l.$(s),a=t.attr("class").indexOf("jvm-region")===-1?"marker":"region",r=a==="region"?t.attr("data-code"):t.attr("data-index"),o=a+":selected";return e&&(o=a+".tooltip:show"),{event:o,type:a,code:r,element:a==="region"?i.regions[r].element:i.markers[r].element,tooltipText:a==="region"?i.mapData.paths[r].name||"":i.markers[r].config.name||""}}var C=function(){function i(){}var s=i.prototype;return s.getLabelText=function(e,t){if(t){if(l.isFunc(t.render)){var a=[];return this.config.marker&&a.push(this.config.marker),a.push(e),t.render.apply(this,a)}return e}},s.getLabelOffsets=function(e,t){return l.isFunc(t.offsets)?t.offsets(e):l.isArr(t.offsets)?t.offsets[e]:[0,0]},s.setStyle=function(e,t){this.shape.setStyle(e,t)},s.remove=function(){this.shape.remove(),this.label&&this.label.remove()},s.hover=function(e){this._setStatus("isHovered",e)},s.select=function(e){this._setStatus("isSelected",e)},s._setStatus=function(e,t){this.shape[e]=t,this.shape.updateStyle(),this[e]=t,this.label&&(this.label[e]=t,this.label.updateStyle())},i}(),N=function(i){function s(e){var t,a=e.map,r=e.code,o=e.path,n=e.style,h=e.label,u=e.labelStyle,p=e.labelsGroup;(t=i.call(this)||this).config=arguments[0],t.canvas=a.canvas,t.map=a,t.shape=t.canvas.createPath({d:o,dataCode:r},n),t.shape.addClass("jvm-region jvm-element");var d=t.shape.getBBox(),m=t.getLabelText(r,h);if(h&&m){var g=t.getLabelOffsets(r);t.labelX=d.x+d.width/2+g[0],t.labelY=d.y+d.height/2+g[1],t.label=t.canvas.createText({text:m,textAnchor:"middle",alignmentBaseline:"central",dataCode:r,x:t.labelX,y:t.labelY},u,p),t.label.addClass("jvm-region jvm-element")}return t}return y(s,i),s.prototype.updateLabelPosition=function(){this.label&&this.label.set({x:this.labelX*this.map.scale+this.map.transX*this.map.scale,y:this.labelY*this.map.scale+this.map.transY*this.map.scale})},s}(C),$=function(i){function s(e){var t,a=e.index,r=e.map,o=e.style,n=e.x1,h=e.y1,u=e.x2,p=e.y2,d=e.group;return(t=i.call(this)||this).shape=r.canvas.createLine({x1:n,y1:h,x2:u,y2:p,dataIndex:a},o,d),t.shape.addClass("jvm-line"),t}return y(s,i),s}(C);function A(i,s){return i.toLowerCase()+":to:"+s.toLowerCase()}var q=function(i){function s(t){var a,r=t.index,o=t.style,n=t.label,h=t.cx,u=t.cy,p=t.map,d=t.group;return(a=i.call(this)||this)._map=p,a._isImage=!!o.initial.image,a.config=arguments[0],a.shape=p.canvas[a._isImage?"createImage":"createCircle"]({dataIndex:r,cx:h,cy:u},a._getStyle(),d),a.shape.addClass("jvm-marker jvm-element"),a._isImage&&a.updateLabelPosition(),n&&a._createLabel(a.config),a}y(s,i);var e=s.prototype;return e.updateLabelPosition=function(){this.label&&this.label.set({x:this._labelX*this._map.scale+this._offsets[0]+this._map.transX*this._map.scale+5+(this._isImage?(this.shape.width||0)/2:this.shape.node.r.baseVal.value),y:this._labelY*this._map.scale+this._map.transY*this._map.scale+this._offsets[1]})},e._createLabel=function(t){var a=t.index,r=t.map,o=t.label,n=t.labelsGroup,h=t.cx,u=t.cy,p=t.marker,d=t.isRecentlyCreated,m=this.getLabelText(a,o);this._labelX=h/r.scale-r.transX,this._labelY=u/r.scale-r.transY,this._offsets=d&&p.offsets?p.offsets:this.getLabelOffsets(a,o),this.label=r.canvas.createText({text:m,dataIndex:a,x:this._labelX,y:this._labelY,dy:"0.6ex"},r.params.markerLabelStyle,n),this.label.addClass("jvm-marker jvm-element"),d&&this.updateLabelPosition()},e._getStyle=function(){var t={};return this._isImage?t.initial={image:this.config.style.initial.image}:t=this.config.style,t},s}(C),U=function(){function i(s){s===void 0&&(s={}),this._options=s,this._map=this._options.map,this._series=this._options.series,this._body=l.createElement("div","jvm-legend"),this._options.cssClass&&this._body.setAttribute("class",this._options.cssClass),s.vertical?this._map.legendVertical.appendChild(this._body):this._map.legendHorizontal.appendChild(this._body),this.render()}return i.prototype.render=function(){var s,e,t,a=this._series.scale.getTicks(),r=l.createElement("div","jvm-legend-inner");if(this._body.innderHTML="",this._options.title){var o=l.createElement("div","jvm-legend-title",this._options.title);this._body.appendChild(o)}this._body.appendChild(r);for(var n=0;n<a.length;n++){switch(s=l.createElement("div","jvm-legend-tick"),e=l.createElement("div","jvm-legend-tick-sample"),this._series.config.attribute){case"fill":l.isImageUrl(a[n].value)?e.style.background="url("+a[n].value+")":e.style.background=a[n].value;break;case"stroke":e.style.background=a[n].value;break;case"image":e.style.background="url("+(l.isObj(a[n].value)?a[n].value.url:a[n].value)+") no-repeat center center",e.style.backgroundSize="cover"}s.appendChild(e),t=a[n].label,this._options.labelRender&&(t=this._options.labelRender(t));var h=l.createElement("div","jvm-legend-tick-text",t);s.appendChild(h),r.appendChild(s)}},i}(),Z=function(){function i(e){this._scale=e}var s=i.prototype;return s.getValue=function(e){return this._scale[e]},s.getTicks=function(){var e=[];for(var t in this._scale)e.push({label:t,value:this._scale[t]});return e},i}(),J=function(){function i(e,t,a){e===void 0&&(e={}),this._map=a,this._elements=t,this._values=e.values||{},this.config=e,this.config.attribute=e.attribute||"fill",e.attributes&&this.setAttributes(e.attributes),l.isObj(e.scale)&&(this.scale=new Z(e.scale)),this.config.legend&&(this.legend=new U(l.merge({map:this._map,series:this},this.config.legend))),this.setValues(this._values)}var s=i.prototype;return s.setValues=function(e){var t={};for(var a in e)e[a]&&(t[a]=this.scale.getValue(e[a]));this.setAttributes(t)},s.setAttributes=function(e){for(var t in e)this._elements[t]&&this._elements[t].element.setStyle(this.config.attribute,e[t])},s.clear=function(){var e,t={};for(e in this._values)this._elements[e]&&(t[e]=this._elements[e].element.shape.style.initial[this.config.attribute]);this.setAttributes(t),this._values={}},i}(),E={mill:function(i,s,e){return{x:this.radius*(s-e)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+.4*i)*this.radDeg))/.8}},merc:function(i,s,e){return{x:this.radius*(s-e)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+i*Math.PI/360))}},aea:function(i,s,e){var t=e*this.radDeg,a=29.5*this.radDeg,r=45.5*this.radDeg,o=i*this.radDeg,n=s*this.radDeg,h=(Math.sin(a)+Math.sin(r))/2,u=Math.cos(a)*Math.cos(a)+2*h*Math.sin(a),p=h*(n-t),d=Math.sqrt(u-2*h*Math.sin(o))/h,m=Math.sqrt(u-2*h*Math.sin(0))/h;return{x:d*Math.sin(p)*this.radius,y:-(m-d*Math.cos(p))*this.radius}},lcc:function(i,s,e){var t=e*this.radDeg,a=s*this.radDeg,r=33*this.radDeg,o=45*this.radDeg,n=i*this.radDeg,h=Math.log(Math.cos(r)*(1/Math.cos(o)))/Math.log(Math.tan(Math.PI/4+o/2)*(1/Math.tan(Math.PI/4+r/2))),u=Math.cos(r)*Math.pow(Math.tan(Math.PI/4+r/2),h)/h,p=u*Math.pow(1/Math.tan(Math.PI/4+n/2),h),d=u*Math.pow(1/Math.tan(Math.PI/4+0),h);return{x:p*Math.sin(h*(a-t))*this.radius,y:-(d-p*Math.cos(h*(a-t)))*this.radius}}};E.degRad=180/Math.PI,E.radDeg=Math.PI/180,E.radius=6381372;var K=function(){function i(e,t){var a=e.scale,r=e.values;this._scale=a,this._values=r,this._fromColor=this.hexToRgb(a[0]),this._toColor=this.hexToRgb(a[1]),this._map=t,this.setMinMaxValues(r),this.visualize()}var s=i.prototype;return s.setMinMaxValues=function(e){for(var t in this.min=Number.MAX_VALUE,this.max=0,e)(t=parseFloat(e[t]))>this.max&&(this.max=t),t<this.min&&(this.min=t)},s.visualize=function(){var e,t={};for(var a in this._values)e=parseFloat(this._values[a]),isNaN(e)||(t[a]=this.getValue(e));this.setAttributes(t)},s.setAttributes=function(e){for(var t in e)this._map.regions[t]&&this._map.regions[t].element.setStyle("fill",e[t])},s.getValue=function(e){for(var t,a="#",r=0;r<3;r++)a+=((t=Math.round(this._fromColor[r]+(this._toColor[r]-this._fromColor[r])*((e-this.min)/(this.max-this.min))).toString(16)).length===1?"0":"")+t;return a},s.hexToRgb=function(e){var t=0,a=0,r=0;return e.length==4?(t="0x"+e[1]+e[1],a="0x"+e[2]+e[2],r="0x"+e[3]+e[3]):e.length==7&&(t="0x"+e[1]+e[2],a="0x"+e[3]+e[4],r="0x"+e[5]+e[6]),[parseInt(t),parseInt(a),parseInt(r)]},i}(),Q=Object.freeze({__proto__:null,handleContainerEvents:function(){var i,s,e=this,t=!1,a=this;this.params.draggable&&(this.container.on("mousemove",function(r){return t&&(a.transX-=(i-r.pageX)/a.scale,a.transY-=(s-r.pageY)/a.scale,a.applyTransform(),i=r.pageX,s=r.pageY,e.isBeingDragged=!0),!1}).on("mousedown",function(r){return t=!0,i=r.pageX,s=r.pageY,!1}),l.$("body").on("mouseup",function(){t=!1})),this.params.zoomOnScroll&&this.container.on("wheel",function(r){var o=0;o=(r.deltaY||-r.wheelDelta||r.detail)>>10||1,o*=75;var n=e.container.selector.getBoundingClientRect(),h=r.pageX-n.left-window.pageXOffset,u=r.pageY-n.top-window.pageYOffset,p=Math.pow(1+a.params.zoomOnScrollSpeed/1e3,-1.5*o);a.tooltip&&a.tooltip.hide(),a.setScale(a.scale*p,h,u)},{passive:!0})},handleElementEvents:function(){var i=this,s=this;this.container.delegate(".jvm-element","mousedown",function(){i.isBeingDragged=!1}),this.container.delegate(".jvm-element","mouseover mouseout",function(e){var t=T(s,this,!0),a=s.params.showTooltip;e.type==="mouseover"?e.defaultPrevented||(t.element.hover(!0),a&&(s.tooltip.text(t.tooltipText),s.tooltip.show(),s.emit(t.event,[s.tooltip,t.code]))):(t.element.hover(!1),a&&s.tooltip.hide())}),this.container.delegate(".jvm-element","mouseup",function(e){var t=T(s,this);if(!s.isBeingDragged&&!e.defaultPrevented&&(t.type==="region"&&s.params.regionsSelectable||t.type==="marker"&&s.params.markersSelectable)){var a=t.element;s.params[t.type+"sSelectableOne"]&&s.clearSelected(t.type+"s"),t.element.isSelected?a.select(!1):a.select(!0),s.emit(t.event,[t.code,a.isSelected,s.getSelected(t.type+"s")])}})},handleZoomButtons:function(){var i=this,s=this,e=l.createElement("div","jvm-zoom-btn jvm-zoomin","&#43;",!0),t=l.createElement("div","jvm-zoom-btn jvm-zoomout","&#x2212",!0);this.container.append(e).append(t),O(e,"click",function(){i.setScale(s.scale*s.params.zoomStep,s.width/2,s.height/2,!1,s.params.zoomAnimate)}),O(t,"click",function(){i.setScale(s.scale/s.params.zoomStep,s.width/2,s.height/2,!1,s.params.zoomAnimate)})},bindContainerTouchEvents:function(){var i,s,e,t,a,r,o,n=this,h=function(u){var p,d,m,g,c=u.touches;if(u.type=="touchstart"&&(o=0),c.length==1)o==1&&(m=n.transX,g=n.transY,n.transX-=(e-c[0].pageX)/n.scale,n.transY-=(t-c[0].pageY)/n.scale,n.tooltip.hide(),n.applyTransform(),m==n.transX&&g==n.transY||u.preventDefault()),e=c[0].pageX,t=c[0].pageY;else if(c.length==2)if(o==2)d=Math.sqrt(Math.pow(c[0].pageX-c[1].pageX,2)+Math.pow(c[0].pageY-c[1].pageY,2))/s,n.setScale(i*d,a,r),n.tooltip.hide(),u.preventDefault();else{var f=n.container.selector.getBoundingClientRect();p={top:f.top+window.scrollY,left:f.left+window.scrollX},a=c[0].pageX>c[1].pageX?c[1].pageX+(c[0].pageX-c[1].pageX)/2:c[0].pageX+(c[1].pageX-c[0].pageX)/2,r=c[0].pageY>c[1].pageY?c[1].pageY+(c[0].pageY-c[1].pageY)/2:c[0].pageY+(c[1].pageY-c[0].pageY)/2,a-=p.left,r-=p.top,i=n.scale,s=Math.sqrt(Math.pow(c[0].pageX-c[1].pageX,2)+Math.pow(c[0].pageY-c[1].pageY,2))}o=c.length};this.container.on("touchstart",h).on("touchmove",h)},createRegions:function(){var i,s;for(i in this.regionLabelsGroup=this.regionLabelsGroup||this.canvas.createGroup("jvm-regions-labels-group"),this.mapData.paths)s=new N({map:this,code:i,path:this.mapData.paths[i].path,style:l.merge({},this.params.regionStyle),labelStyle:this.params.regionLabelStyle,labelsGroup:this.regionLabelsGroup,label:this.params.labels&&this.params.labels.regions}),this.regions[i]={config:this.mapData.paths[i],element:s}},createLines:function(i,s,e){var t=this;e===void 0&&(e=!1);var a,r=!1,o=!1;for(var n in this.linesGroup=this.linesGroup||this.canvas.createGroup("jvm-lines-group"),i){var h=i[n];for(var u in s){var p=e?s[u].config:s[u];p.name===h.from&&(r=this.getMarkerPosition(p)),p.name===h.to&&(o=this.getMarkerPosition(p))}r!==!1&&o!==!1&&(a=new $({index:n,map:this,style:l.mergeDeeply({initial:this.params.lineStyle},{initial:h.style||{}}),x1:r.x,y1:r.y,x2:o.x,y2:o.y,group:this.linesGroup}),e&&Object.keys(this.lines).forEach(function(d){d===A(i[0].from,i[0].to)&&t.lines[d].element.remove()}),this.lines[A(h.from,h.to)]={element:a,config:h})}},createMarkers:function(i,s){var e,t,a,r,o=this;for(var n in i===void 0&&(i={}),s===void 0&&(s=!1),this.markersGroup=this.markersGroup||this.canvas.createGroup("jvm-markers-group"),this.markerLabelsGroup=this.markerLabelsGroup||this.canvas.createGroup("jvm-markers-labels-group"),i){if(e=i[n],a=this.getMarkerPosition(e),r=e.coords.join(":"),s){if(l.keys(this.markers).filter(function(h){return o.markers[h]._uid===r}).length)continue;n=l.keys(this.markers).length}a!==!1&&(t=new q({index:n,map:this,style:l.mergeDeeply(this.params.markerStyle,{initial:e.style||{}}),label:this.params.labels&&this.params.labels.markers,labelsGroup:this.markerLabelsGroup,cx:a.x,cy:a.y,group:this.markersGroup,marker:e,isRecentlyCreated:s}),this.markers[n]&&this.removeMarkers([n]),this.markers[n]={_uid:r,config:e,element:t})}},createTooltip:function(){var i=this,s=l.createElement("div","jvm-tooltip");this.tooltip=l.$(document.body.appendChild(s)),this.container.on("mousemove",function(e){if(i.tooltip.selector.style.display==="block"){var t=i.container.selector.querySelector("#jvm-regions-group").getBoundingClientRect(),a=s.getBoundingClientRect(),r=a.height,o=a.width,n=e.clientY<=t.top+r+5,h=e.pageY-r-5,u=e.pageX-o-5;n&&(h+=r+5,u-=10),e.clientX<t.left+o+5&&(u=e.pageX+5+2,n&&(u+=10)),i.tooltip.css({top:h+"px",left:u+"px"})}})},createSeries:function(){for(var i in this.series={markers:[],regions:[]},this.params.series)for(var s=0;s<this.params.series[i].length;s++)this.series[i][s]=new J(this.params.series[i][s],this[i],this)},applyTransform:function(){var i,s,e,t;this.defaultWidth*this.scale<=this.width?(i=(this.width-this.defaultWidth*this.scale)/(2*this.scale),e=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(i=0,e=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(s=(this.height-this.defaultHeight*this.scale)/(2*this.scale),t=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(s=0,t=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>s?this.transY=s:this.transY<t&&(this.transY=t),this.transX>i?this.transX=i:this.transX<e&&(this.transX=e),this.canvas.applyTransformParams(this.scale,this.transX,this.transY),this.markers&&this.repositionMarkers(),this.lines&&this.repositionLines(),this.repositionLabels()},setFocus:function(i){var s=this;i===void 0&&(i={});var e,t=[];if(i.region?t.push(i.region):i.regions&&(t=i.regions),t.length)return t.forEach(function(n){if(s.regions[n]){var h=s.regions[n].element.shape.getBBox();h&&(e=e===void 0?h:{x:Math.min(e.x,h.x),y:Math.min(e.y,h.y),width:Math.max(e.x+e.width,h.x+h.width)-Math.min(e.x,h.x),height:Math.max(e.y+e.height,h.y+h.height)-Math.min(e.y,h.y)})}}),this.setScale(Math.min(this.width/e.width,this.height/e.height),-(e.x+e.width/2),-(e.y+e.height/2),!0,i.animate);if(i.coords){var a=this.coordsToPoint(i.coords[0],i.coords[1]),r=this.transX-a.x/this.scale,o=this.transY-a.y/this.scale;return this.setScale(i.scale*this.baseScale,r,o,!0,i.animate)}},resize:function(){var i=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/i,this.transX*=this.baseScale/i,this.transY*=this.baseScale/i},setScale:function(i,s,e,t,a){var r,o,n,h,u,p,d,m,g,c,f=this,M=0,_=Math.abs(Math.round(60*(i-this.scale)/Math.max(i,this.scale)));i>this.params.zoomMax*this.baseScale?i=this.params.zoomMax*this.baseScale:i<this.params.zoomMin*this.baseScale&&(i=this.params.zoomMin*this.baseScale),s!==void 0&&e!==void 0&&(r=i/this.scale,t?(g=s+this.defaultWidth*(this.width/(this.defaultWidth*i))/2,c=e+this.defaultHeight*(this.height/(this.defaultHeight*i))/2):(g=this.transX-(r-1)/i*s,c=this.transY-(r-1)/i*e)),a&&_>0?(n=this.scale,h=(i-n)/_,u=this.transX*this.scale,d=this.transY*this.scale,p=(g*i-u)/_,m=(c*i-d)/_,o=setInterval(function(){M+=1,f.scale=n+h*M,f.transX=(u+p*M)/f.scale,f.transY=(d+m*M)/f.scale,f.applyTransform(),M==_&&(clearInterval(o),f.emit("viewport:changed",[f.scale,f.transX,f.transY]))},10)):(this.transX=g,this.transY=c,this.scale=i,this.applyTransform(),this.emit("viewport:changed",[this.scale,this.transX,this.transY]))},updateSize:function(){this.width=this.container.width(),this.height=this.container.height(),this.resize(),this.canvas.setSize(this.width,this.height),this.applyTransform()},coordsToPoint:function(i,s){var e,t,a,r=v.maps[this.params.map].projection,o=r.centralMeridian;return e=E[r.type](i,s,o),!!(t=this.getInsetForPoint(e.x,e.y))&&(a=t.bbox,e.x=(e.x-a[0].x)/(a[1].x-a[0].x)*t.width*this.scale,e.y=(e.y-a[0].y)/(a[1].y-a[0].y)*t.height*this.scale,{x:e.x+this.transX*this.scale+t.left*this.scale,y:e.y+this.transY*this.scale+t.top*this.scale})},getInsetForPoint:function(i,s){var e,t,a=v.maps[this.params.map].insets;for(e=0;e<a.length;e++)if(i>(t=a[e].bbox)[0].x&&i<t[1].x&&s>t[0].y&&s<t[1].y)return a[e]},getMarkerPosition:function(i){var s=i.coords;return v.maps[this.params.map].projection?this.coordsToPoint.apply(this,s):{x:s[0]*this.scale+this.transX*this.scale,y:s[1]*this.scale+this.transY*this.scale}},repositionLines:function(){var i=!1,s=!1;for(var e in this.lines){for(var t in this.markers){var a=this.markers[t];a.config.name===this.lines[e].config.from&&(i=this.getMarkerPosition(a.config)),a.config.name===this.lines[e].config.to&&(s=this.getMarkerPosition(a.config))}i!==!1&&s!==!1&&this.lines[e].element.setStyle({x1:i.x,y1:i.y,x2:s.x,y2:s.y})}},repositionMarkers:function(){var i;for(var s in this.markers)(i=this.getMarkerPosition(this.markers[s].config))!==!1&&this.markers[s].element.setStyle({cx:i.x,cy:i.y})},repositionLabels:function(){var i=this.params.labels;if(i){if(i.regions)for(var s in this.regions)this.regions[s].element.updateLabelPosition();if(i.markers)for(var e in this.markers)this.markers[e].element.updateLabelPosition()}},visualizeData:function(i){l.isObj(i)&&(this.dataVisualization=new K(i,this))}}),z={onViewportChange:"viewport:changed",onRegionSelected:"region:selected",onMarkerSelected:"marker:selected",onRegionTooltipShow:"region.tooltip:show",onMarkerTooltipShow:"marker.tooltip:show",onLoaded:"map:loaded",onDestroyed:"map:destroyed"},v=function(){function i(e){if(e===void 0&&(e={}),this.params=l.mergeDeeply(i.defaults,e),!i.maps[this.params.map])throw new Error("Attempt to use map which was not loaded: "+e.map);this.mapData=i.maps[this.params.map],this.regions={},this.markers={},this.lines={},this.defaultWidth=this.mapData.width,this.defaultHeight=this.mapData.height,this.height=0,this.width=0,this.scale=1,this.baseScale=1,this.transX=0,this.transY=0,this.baseTransX=0,this.baseTransY=0,this.isBeingDragged=!1,this.selector=e.selector,window.document.readyState!=="loading"?this.init(e.selector):window.addEventListener("DOMContentLoaded",this.init.bind(this,e.selector))}var s=i.prototype;return s.init=function(e){var t=this.params;this.container=l.$(e).addClass("jvm-container"),this.canvas=new F(this.container,this.width,this.height),this.setBackgroundColor(t.backgroundColor),this.handleContainerEvents(),this.createRegions(),this.updateSize(),this.createLines(t.lines||{},t.markers||{}),this.createMarkers(t.markers),this.handleElementEvents(),this.repositionLabels(),t.showTooltip&&this.createTooltip(),t.zoomButtons&&this.handleZoomButtons(),t.selectedRegions&&this.setSelected("regions",t.selectedRegions),t.selectedMarkers&&this.setSelected("markers",t.selectedMarkers),t.focusOn&&this.setFocus(t.focusOn),t.visualizeData&&this.visualizeData(t.visualizeData),t.bindTouchEvents&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)&&this.bindContainerTouchEvents(),t.series&&(this.container.append(this.legendHorizontal=l.createElement("div","jvm-series-container jvm-series-h")).append(this.legendVertical=l.createElement("div","jvm-series-container jvm-series-v")),this.createSeries()),this.emit("map:loaded",[this])},s.emit=function(e,t){for(var a in z)z[a]===e&&l.isFunc(this.params[a])&&this.params[a].apply(this,t)},s.setBackgroundColor=function(e){this.container.css({backgroundColor:e})},s.getSelected=function(e){var t,a=[];for(t in this[e])this[e][t].element.isSelected&&a.push(t);return a},s.clearSelected=function(e){var t=this;this.getSelected(e).forEach(function(a){t[e][a].element.select(!1)})},s.setSelected=function(e,t){var a=this;t.forEach(function(r){a[e][r]&&a[e][r].element.select(!0)})},s.getSelectedRegions=function(){return this.getSelected("regions")},s.clearSelectedRegions=function(){var e=this;this.getSelected("regions").forEach(function(t){e.regions[t].element.select(!1)})},s.getSelectedMarkers=function(){return this.getSelected("markers")},s.clearSelectedMarkers=function(){var e=this;this.getSelected("markers").forEach(function(t){e.markers[t].element.select(!1)})},s.addMarker=function(e){console.warn("`addMarker` method is depreacted, please use `addMarkers` instead."),this.createMarkers([e],!0)},s.addMarkers=function(e){if(typeof e=="object")return this.createMarkers([e],!0);this.createMarkers(e,!0)},s.removeMarkers=function(e){var t=this;e||(e=Object.keys(this.markers)),e.forEach(function(a){t.markers[a].element.remove(),delete t.markers[a]})},s.addLine=function(e,t,a){a===void 0&&(a={}),this.createLines([{from:e,to:t,style:a}],this.markers,!0)},s.reset=function(){for(var e in this.series)for(var t=0;t<this.series[e].length;t++)this.series[e][t].clear();this.legendHorizontal&&(l.removeElement(this.legendHorizontal),this.legendHorizontal=null),this.legendVertical&&(l.removeElement(this.legendVertical),this.legendVertical=null),this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform(),this.clearSelectedMarkers(),this.clearSelectedRegions(),this.removeMarkers()},s.destroy=function(e){var t=this;e===void 0&&(e=!0);var a=P(),r=this.tooltip.selector,o=Object.keys;l.removeElement(r),o(a).forEach(function(n){D(a[n].selector,n,a[n].handler)}),this.emit("map:destroyed"),e&&o(this).forEach(function(n){try{delete t[n]}catch{}})},s.extend=function(e,t){i.prototype[e]=t},s.getUtils=function(){return l},i}();v.maps={},v.defaults={map:"world",backgroundColor:"tranparent",draggable:!0,zoomButtons:!0,zoomOnScroll:!0,zoomOnScrollSpeed:3,zoomMax:12,zoomMin:1,zoomAnimate:!0,showTooltip:!0,zoomStep:1.5,bindTouchEvents:!0,lineStyle:{stroke:"#808080",strokeWidth:1,strokeLinecap:"round"},markersSelectable:!1,markersSelectableOne:!1,markerStyle:{initial:{r:7,fill:"#374151",fillOpacity:1,stroke:"#FFF",strokeWidth:5,strokeOpacity:.5},hover:{fill:"#3cc0ff",cursor:"pointer"},selected:{fill:"blue"},selectedHover:{}},markerLabelStyle:{initial:{fontFamily:"Verdana",fontSize:12,fontWeight:500,cursor:"default",fill:"#374151"},hover:{cursor:"pointer"},selected:{},selectedHover:{}},regionsSelectable:!1,regionsSelectableOne:!1,regionStyle:{initial:{fill:"#dee2e8",fillOpacity:1,stroke:"none",strokeWidth:0},hover:{fillOpacity:.7,cursor:"pointer"},selected:{fill:"#9ca3af"},selectedHover:{}},regionLabelStyle:{initial:{fontFamily:"Verdana",fontSize:"12",fontWeight:"bold",cursor:"default",fill:"#35373e"},hover:{cursor:"pointer"}}},Object.assign(v.prototype,Q);var ee=function(){function i(s){if(s===void 0&&(s={}),!s.selector)throw new Error("Selector is not given.");return new v(s)}return i.prototype.addMap=function(s,e){v.maps[s]=e},i}();return window.jsVectorMap=ee});
